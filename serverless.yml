service: amazon-scraper

frameworkVersion: '3'

provider:
  name: aws
  runtime: nodejs20.x
  region: us-east-1
  timeout: 300
  memorySize: 1024
  environment:
    NODE_ENV: production
  iam:
    role:
      statements:
        - Effect: Allow
          Action:
            - logs:CreateLogGroup
            - logs:CreateLogStream
            - logs:PutLogEvents
          Resource: '*'

functions:
  scrapeAmazonSponsoredProducts:
    handler: dist/lambda-handler.scrapeAmazonSponsoredProducts
    timeout: 300
    memorySize: 1024
    events:
      - http:
          path: /scrape
          method: get
          cors: true
          request:
            parameters:
              querystrings:
                q: false
                search: false

# plugins:
  # - serverless-plugin-typescript

package:
  patterns:
    - '!test/**'
    - '!*.md'
    - '!.git/**'
    - '!src/__tests__/**'
    - '!src/**/*.ts'
    - 'dist/**'
    - 'node_modules/**'